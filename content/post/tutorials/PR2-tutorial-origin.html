---
title: "Plotting origin of PR2 sequences "
summary: "Drawing bar graphs of country and ocean of origin"
author: vaulot
date: '2018-08-15'
lastmod: "2019-11-24"
categories: ["tutorial"]
tags: ["documentation", "R-package", "tutorial", "metadata"]
---



<div id="installation" class="section level1">
<h1>Installation</h1>
<p>Install from the GitHub web site using the devtools package</p>
<pre class="r"><code>install.packages(devtools)
devtools::install_github(&quot;pr2database/pr2database&quot;)</code></pre>
</div>
<div id="loading-the-database" class="section level1">
<h1>Loading the database</h1>
<pre class="r"><code>library(&quot;pr2database&quot;)

data(&quot;pr2&quot;)
</code></pre>
</div>
<div id="load-the-libraries" class="section level1">
<h1>Load the libraries</h1>
<pre class="r"><code>  library(dplyr)
  library(ggplot2)    # For plots</code></pre>
</div>
<div id="plotting-number-of-sequences-per-country-and-ocean" class="section level1">
<h1>Plotting number of sequences per country and ocean</h1>
<p>A very good tutorial by <a href="https://twitter.com/MargaretBrisbin">Margaret Mars Brisbin</a> on how to combine PR2 metadata with Python to locate sequences using all the metadata information (lat, long, country and fuzzy localization): <a href="https://maggimars.github.io/eukGeoBlast/eGB.html" class="uri">https://maggimars.github.io/eukGeoBlast/eGB.html</a> and <a href="https://github.com/maggimars/eukGeoBlast" class="uri">https://github.com/maggimars/eukGeoBlast</a>. This code has been used to incorporate more geo-localisation information into PR2 version 4.12.0</p>
<div id="number-of-sequences-per-country-of-origin" class="section level2">
<h2>Number of sequences per country of origin</h2>
<pre class="r"><code>
  countries &lt;- pr2 %&gt;%
    count(pr2_country) %&gt;%
    arrange(-n) %&gt;%
    filter(!is.na(pr2_country) &amp; n &gt; 500)

  ggplot(countries, aes(x = reorder(pr2_country, n), y = n)) +
    geom_col() +
    coord_flip() +
    xlab(&quot;&quot;)  + ylab(&quot;Number of PR2 sequences&quot;)</code></pre>
<p><img src="/post/tutorials/PR2-tutorial-origin_files/figure-html/sequence_country-1.png" width="672" /></p>
</div>
<div id="number-of-sequences-per-ocean-of-origin" class="section level2">
<h2>Number of sequences per ocean of origin</h2>
<pre class="r"><code>
  oceans &lt;- pr2 %&gt;%
    count(pr2_ocean) %&gt;%
    arrange(-n) %&gt;%
    filter(!is.na(pr2_ocean))

  ggplot(oceans, aes(x = reorder(pr2_ocean, n), y = n)) +
    geom_col() +
    coord_flip() +
    xlab(&quot;&quot;)  + ylab(&quot;Number of PR2 sequences&quot;)</code></pre>
<p><img src="/post/tutorials/PR2-tutorial-origin_files/figure-html/sequence_oceans-1.png" width="672" /></p>
</div>
</div>
